// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
  previewFeatures = ["postgresqlExtensions", "typedSql"] // 
}

datasource db {
  provider = "postgresql"
  extensions = [postgis] //
}

model User {
  id        String   @id @default(uuid())
  name      String
  email     String   @unique
  passwordHash String
  phone     String?  @unique
  karma     Int      @default(0)
  items     Item[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Item {
  id          String   @id @default(uuid())
  title       String
  description String
  category    String   // e.g., "Tools", "Kitchen", "Baby Gear"
  isAvailable Boolean  @default(true)
  
  // PostGIS location point
  location    Unsupported("geography(Point, 4326)") 
  
  owner       User     @relation(fields: [ownerId], references: [id])
  ownerId     String
  createdAt   DateTime @default(now())

  @@index([location], name: "location_idx", type: Gist)
}